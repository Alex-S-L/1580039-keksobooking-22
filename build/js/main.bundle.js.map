{"version":3,"sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/card.js","webpack://keksobooking/./source/js/form-access.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/server-interaction.js","webpack://keksobooking/./source/js/preview-handler.js","webpack://keksobooking/./source/js/form.js"],"names":["debounce","f","ms","fnCall","apply","this","arguments","clearTimeout","setTimeout","HousingTypeNames","BUNGALOW","FLAT","HOUSE","PALACE","advertisementCardTemplate","document","querySelector","content","setAdvertisementDataSource","element","advertisementData","src","setAdvertisementDataText","textContent","setAdvertisementDataCapacityText","advertisementDataOne","advertisementDataTwo","setAdvertisementDataTimeText","isDataEmpty","Array","isArray","length","setAdvertisementData","callback","classList","add","remove","setAdvertisementConcatenatedData","setAdvertisementDataList","data","appendChild","renderFeatureItems","features","featureItems","createDocumentFragment","forEach","feature","featureElement","createElement","renderPhotoItems","photos","photoItems","photo","photoElement","width","height","alt","FORM_DISABLED_CLASS","formFieldsets","querySelectorAll","mapFilterBox","mapFilters","switchFormAccess","elements","contains","switchAccessClass","disabled","switchElementsDisability","toggleFormState","filters","typeFilter","priceFilter","roomsFilter","guestsFilter","featuresFilters","checkFilters","item","offer","type","offerType","typeFilterValue","value","checkType","price","offerPrice","priceFilterValue","checkPrice","rooms","offerRooms","roomsFilterValue","anyValue","equalValue","toString","checkRooms","guests","offerGuests","guestsFilterValue","checkGuests","offerFeatures","chosenFeatures","checked","push","getChosenFeatures","every","chosenFeature","includes","checkFeatures","filtrationHandler","advertisements","markerCount","cb","filter","slice","bindFiltrationOnChange","debounceHandler","bind","addEventListener","TOWN_COORDINATES","lat","lng","mainMarkerCoordinates","MAIN_MARKER_START_COORDINATES","address","pinSize","pinAnchor","map","L","tileLayer","attribution","mainMarkerPin","icon","iconUrl","iconSize","iconAnchor","ordinaryMarkerPin","mainMarker","marker","draggable","markerGroup","layerGroup","concatenateCoordinates","toFixed","addMarkers","clearLayers","advertisement","location","x","y","bindPopup","advertisementCard","cloneNode","avatar","title","adress","capacity","time","description","author","toUpperCase","checkin","checkout","getAdvertisementCard","addTo","onSuccess","on","setView","getLatLng","resetMarkersOnSubmit","fetch","then","response","ok","json","Error","status","statusText","catch","message","alertContainer","style","padding","textAlign","color","backgroundColor","position","left","top","transform","zIndex","body","removeChild","getAlertPopup","FILE_EXTENSIONS","previewHandler","previewElement","file","files","isCorrectExtension","fileName","name","toLowerCase","some","extension","endsWith","isImg","tagName","reader","FileReader","result","backgroundImage","readAsDataURL","MinPrices","housingType","housingPrice","timeField","checkinTime","checkoutTime","roomNumber","errorMessage","successMessage","main","avatarInput","roomPhotoInput","avatarPreview","roomPhotoPreview","setAccomodationValidity","capacityValue","roomsValue","firstException","secondException","setCustomValidity","reportValidity","randomPlaceClickHandler","window","removeEventListener","escapeKeydownHandler","evt","keyCode","showFailPopup","showSuccessPopup","reset","setLatLng","min","placeholder","removeAttribute","target","preventDefault","currentFormData","FormData","onFail","method","sendData"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const getAlertPopup = (message) => {\n  const alertContainer = document.createElement('div')\n  alertContainer.style.width = '300px';\n  alertContainer.style.padding = '20px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.color = 'white';\n  alertContainer.style.backgroundColor = '#ccc';\n  alertContainer.style.position = 'fixed';\n  alertContainer.style.left = '50%'\n  alertContainer.style.top = '50%'\n  alertContainer.style.transform = 'translate(-50%, -50%)';\n  alertContainer.style.zIndex = '666';\n  alertContainer.textContent = message;\n  document.body.appendChild(alertContainer);\n  setTimeout(() => {document.body.removeChild(alertContainer)}, 2000);\n}\n\nconst debounce = (f, ms) => {\n  return function() {\n    const fnCall = () => {\n      f.apply(this, arguments);\n    };\n    clearTimeout(fnCall);\n    setTimeout(fnCall, ms);\n  };\n}\n\nexport {getAlertPopup, debounce};\n","const HousingTypeNames = {\n  BUNGALOW: 'Бунгало',\n  FLAT: 'Квартира',\n  HOUSE: 'Дом',\n  PALACE: 'Дворец',\n};\n\nconst advertisementCardTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst setAdvertisementDataSource = (element, advertisementData) => {\n  element.src = advertisementData;\n}\n\nconst setAdvertisementDataText = (element, advertisementData) => {\n  element.textContent = advertisementData;\n}\n\nconst setAdvertisementDataCapacityText = (element, advertisementDataOne, advertisementDataTwo) => {\n  element.textContent = advertisementDataOne + ' комнат для ' + advertisementDataTwo + ' гостей';\n}\n\nconst setAdvertisementDataTimeText = (element, advertisementDataOne, advertisementDataTwo) => {\n  element.textContent = 'Заезд после ' + advertisementDataOne + ', Выезд до ' + advertisementDataTwo;\n}\n\nconst isDataEmpty = (advertisementData) => {\n  return (!advertisementData || (Array.isArray(advertisementData) && !advertisementData.length));\n}\n\nconst setAdvertisementData = (element, advertisementData, callback) => {\n  if (isDataEmpty(advertisementData)) {\n    element.classList.add('hidden');\n  } else {\n    element.classList.remove('hidden');\n    callback(element, advertisementData);\n  }\n}\n\nconst setAdvertisementConcatenatedData = (element, advertisementDataOne, advertisementDataTwo, callback) => {\n  if (isDataEmpty(advertisementDataOne) || isDataEmpty(advertisementDataTwo)) {\n    element.classList.add('hidden');\n  } else {\n    element.classList.remove('hidden');\n    callback(element, advertisementDataOne, advertisementDataTwo);\n  }\n}\n\nconst setAdvertisementDataList = (element, data, callback) => {\n  element.textContent = '';\n  if (isDataEmpty(data)) {\n    element.classList.add('hidden');\n  } else {\n    element.classList.remove('hidden');\n    element.appendChild(callback(data));\n  }\n}\n\nconst renderFeatureItems = (features) => {\n  const featureItems = document.createDocumentFragment() ;\n  features.forEach((feature) => {\n    const featureElement = document.createElement('li');\n    featureElement.classList.add('popup__feature');\n    featureElement.classList.add('popup__feature' + '--' + feature);\n    featureItems.appendChild(featureElement);\n  });\n  return featureItems;\n}\n\nconst renderPhotoItems = (photos) => {\n  const photoItems = document.createDocumentFragment();\n  photos.forEach((photo) => {\n    const photoElement = document.createElement('img');\n    photoElement.classList.add('.popup__photo');\n    photoElement.src = photo;\n    photoElement.width = 45;\n    photoElement.height = 45;\n    photoElement.alt = 'Фотография жилья';\n    photoItems.appendChild(photoElement);\n  });\n  return photoItems;\n}\n\nconst getAdvertisementCard = (advertisement) => {\n  const advertisementCard = advertisementCardTemplate.cloneNode(true);\n  const avatar = advertisementCard.querySelector('.popup__avatar');\n  const title = advertisementCard.querySelector('.popup__title');\n  const adress = advertisementCard.querySelector('.popup__text--address');\n  const price = advertisementCard.querySelector('.popup__text--price');\n  const type = advertisementCard.querySelector('.popup__type');\n  const capacity = advertisementCard.querySelector('.popup__text--capacity');\n  const time = advertisementCard.querySelector('.popup__text--time');\n  const features = advertisementCard.querySelector('.popup__features');\n  const description = advertisementCard.querySelector('.popup__description');\n  const photos = advertisementCard.querySelector('.popup__photos');\n\n  setAdvertisementData(avatar, advertisement.author.avatar, setAdvertisementDataSource);\n  setAdvertisementData(title, advertisement.offer.title, setAdvertisementDataText);\n  setAdvertisementData(adress, advertisement.offer.description, setAdvertisementDataText);\n  setAdvertisementData(price, advertisement.offer.price, setAdvertisementDataText);\n  setAdvertisementData(type, HousingTypeNames[advertisement.offer.type.toUpperCase()], setAdvertisementDataText);\n  setAdvertisementConcatenatedData(capacity, advertisement.offer.rooms, advertisement.offer.guests, setAdvertisementDataCapacityText);\n  setAdvertisementConcatenatedData(time, advertisement.offer.checkin, advertisement.offer.checkout, setAdvertisementDataTimeText);\n  setAdvertisementDataList(features, advertisement.offer.features, renderFeatureItems);\n  setAdvertisementData(description, advertisement.offer.description, setAdvertisementDataText);\n  setAdvertisementDataList(photos, advertisement.offer.photos, renderPhotoItems);\n\n  return advertisementCard;\n}\n\nexport {getAdvertisementCard}\n","const FORM_DISABLED_CLASS = 'ad-form--disabled';\n\nconst form = document.querySelector('.ad-form');\nconst formFieldsets = form.querySelectorAll('.ad-form__element', '.ad-form-header');\nconst mapFilterBox = document.querySelector('.map__filters');\nconst mapFilters = mapFilterBox.querySelectorAll('.map__filter', '.map__features');\n\nconst switchAccessClass = (element) => {\n  (element.classList.contains(FORM_DISABLED_CLASS)) ?\n    element.classList.remove(FORM_DISABLED_CLASS) :\n    element.classList.add(FORM_DISABLED_CLASS);\n}\n\nconst switchElementsDisability = (elements) => {\n  elements.forEach((element) => {\n    element.disabled = !element.disabled;\n  })\n}\n\nconst switchFormAccess = (element, elements) => {\n  switchAccessClass(element);\n  switchElementsDisability(elements);\n}\n\nconst toggleFormState = () => {\n  switchFormAccess(form, formFieldsets);\n  switchFormAccess(mapFilterBox, mapFilters);\n}\n\ntoggleFormState();\n\nexport {toggleFormState};\n","import {debounce} from './util.js'\nconst DEBOUNCE_TIMEOUT = 500;\n\nconst PricePoints = {\n  LOW: 10000,\n  MIDDLE: 50000,\n};\nconst TypeFilterValues = {\n  ANY: 'any',\n  PALACE: 'palace',\n  FLAT: 'flat',\n  HOUSE: 'house',\n  BUNGALOW: 'bungalow',\n};\nconst PriceFilterValues = {\n  ANY: 'any',\n  LOW: 'low',\n  MIDDLE: 'middle',\n  HIGH: 'high',\n};\nconst RoomsFilterValues = {\n  ANY: 'any',\n  ONE: '1',\n  TWO: '2',\n  THREE: '3',\n};\nconst GuestsFilterValues = {\n  ANY: 'any',\n  ONE: '1',\n  TWO: '2',\n  NOT_FOR_GUESTS: '0',\n};\n\nconst filters = document.querySelector('.map__filters');\nconst typeFilter = filters.querySelector('#housing-type');\nconst priceFilter = filters.querySelector('#housing-price');\nconst roomsFilter = filters.querySelector('#housing-rooms');\nconst guestsFilter  = filters.querySelector('#housing-guests');\nconst featuresFilters = filters.querySelectorAll('.map__checkbox');\n\nconst checkType = ({offer: {type : offerType}}) => {\n  const typeFilterValue = typeFilter.value;\n  const anyValue = typeFilterValue === TypeFilterValues.ANY;\n  const equalValue = offerType === typeFilterValue;\n\n  return anyValue || equalValue;\n}\n\nconst checkPrice = ({offer: {price : offerPrice}}) => {\n  const priceFilterValue = priceFilter.value;\n\n  const anyPrice = priceFilterValue === PriceFilterValues.ANY;\n  const lowPrice = priceFilterValue === PriceFilterValues.LOW && offerPrice < PricePoints.LOW;\n  const middlePrice = priceFilterValue === PriceFilterValues.MIDDLE &&\n  (offerPrice >= PricePoints.LOW && offerPrice < PricePoints.MIDDLE);\n  const highPrice = priceFilterValue === PriceFilterValues.HIGH && offerPrice >= PricePoints.MIDDLE;\n\n  return anyPrice || lowPrice || middlePrice || highPrice;\n}\n\nconst checkRooms = ({offer: {rooms: offerRooms}}) => {\n  const roomsFilterValue = roomsFilter.value;\n\n  const anyValue = roomsFilterValue === RoomsFilterValues.ANY;\n  const equalValue = roomsFilterValue === offerRooms.toString();\n\n  return anyValue || equalValue;\n}\n\nconst checkGuests = ({offer: {guests: offerGuests}}) => {\n  const guestsFilterValue = guestsFilter.value;\n\n  const anyValue = guestsFilterValue === GuestsFilterValues.ANY\n  const equalValue = guestsFilterValue === offerGuests.toString()\n\n  return anyValue || equalValue;\n}\n\nconst getChosenFeatures = () => {\n  const chosenFeatures = []\n  featuresFilters.forEach((feature) => {\n    if (feature.checked) {\n      chosenFeatures.push(feature.value)\n    }\n  })\n  return chosenFeatures;\n}\n\nconst checkFeatures = ({offer: {features: offerFeatures}}) => {\n  const chosenFeatures = getChosenFeatures()\n\n  return chosenFeatures.every((chosenFeature) => {\n    return offerFeatures.includes(chosenFeature);\n  });\n};\n\nconst checkFilters = (item) => {\n  return checkType(item) &&\n  checkPrice(item) &&\n  checkRooms(item) &&\n  checkGuests(item) &&\n  checkFeatures(item);\n}\n\nconst filtrationHandler = (advertisements, markerCount, cb) => {\n  const filteredAdvertisements = advertisements.filter((checkFilters)).slice(0, markerCount);\n  cb(filteredAdvertisements);\n}\n\nconst bindFiltrationOnChange = (advertisements, markerCount, cb) => {\n  const debounceHandler = debounce(\n    filtrationHandler.bind(this, advertisements, markerCount, cb),\n    DEBOUNCE_TIMEOUT);\n\n  filters.addEventListener('change', debounceHandler);\n}\n\nconst resetFilters = () => {\n  typeFilter.value = TypeFilterValues.ANY\n  priceFilter.value = PriceFilterValues.ANY\n  roomsFilter.value = RoomsFilterValues.ANY\n  guestsFilter.value = GuestsFilterValues.ANY\n  featuresFilters.forEach((feature) => {feature.checked = false})\n}\n\nexport {bindFiltrationOnChange, resetFilters}\n","/* global L:readonly */\nimport {getAdvertisementCard} from './card.js';\nimport {toggleFormState as mapLoadHandler} from './form-access.js';\nimport {getData} from './server-interaction.js';\nimport {bindFiltrationOnChange} from './filter.js';\nconst MARKERS_COUNT = 10;\n\nconst TOWN_COORDINATES = {\n  lat: 35.68742,\n  lng: 139.77356,\n};\nlet mainMarkerCoordinates = {\n  lat: 35.68742,\n  lng: 139.77356,\n};\nconst MAIN_MARKER_START_COORDINATES = {\n  lat: 35.68742,\n  lng: 139.77356,\n};\n\nconst form = document.querySelector('.ad-form');\nconst address = document.querySelector('#address');\nconst initialScale = 10;\nconst coordinatesPrecision = 5;\nconst pinSize = [50, 50];\nconst pinAnchor = [pinSize[0] / 2, pinSize[1]];\n\nconst map = L.map('map-canvas');\nconst tileLayer = L.tileLayer(/*'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'*/\n  'https://tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n);\nconst mainMarkerPin = L.icon({\n  iconUrl: '../img/main-pin.svg',\n  iconSize: pinSize,\n  iconAnchor: pinAnchor,\n});\nconst ordinaryMarkerPin = L.icon({\n  iconUrl: '../img/pin.svg',\n  iconSize: pinSize,\n  iconAnchor: pinAnchor,\n});\nconst mainMarker = L.marker(\n  mainMarkerCoordinates,\n  {\n    draggable: true,\n    icon: mainMarkerPin,\n  },\n);\nconst markerGroup = L.layerGroup([]);\n\nconst concatenateCoordinates = ({lat, lng}) => {\n  const x = lat.toFixed(coordinatesPrecision);\n  const y = lng.toFixed(coordinatesPrecision);\n  return `${x} ${y}`;\n}\n\nconst addressHandler = () => {\n  mainMarkerCoordinates = mainMarker.getLatLng();\n  address.value = concatenateCoordinates(mainMarkerCoordinates);\n}\n\nconst resetMapState = () => {\n  map.setView(TOWN_COORDINATES, initialScale);\n}\n\nconst resetMainMarkerCoordinates = () => {\n  mainMarker.setLatLng(MAIN_MARKER_START_COORDINATES);\n}\n\nconst addMarkers = (advertisements) => {\n  markerGroup.clearLayers();\n  advertisements.forEach((advertisement) => {\n    let {location: {lat: x, lng: y}} = advertisement\n    const marker = L.marker(\n      {\n        lat: x,\n        lng: y,\n      },\n      {\n        draggable: false,\n        icon: ordinaryMarkerPin,\n      },\n    );\n    marker.bindPopup(getAdvertisementCard(advertisement));\n    marker.addTo(markerGroup);\n  })\n}\n\nconst resetMarkersOnSubmit = (advertisements) => {\n  form.addEventListener('submit', () => {\n    addMarkers(advertisements)\n  })\n}\n\nconst initMapMarkers = (advertisements) => {\n  addMarkers(advertisements);\n  bindFiltrationOnChange(advertisements, MARKERS_COUNT, addMarkers);\n  resetMarkersOnSubmit(advertisements);\n}\n\nmap.on('load', mapLoadHandler).setView(TOWN_COORDINATES, initialScale);\ntileLayer.addTo(map);\nmainMarker.addTo(map);\nmarkerGroup.addTo(map)\naddress.value = concatenateCoordinates(mainMarkerCoordinates);\nmainMarker.on('moveend', addressHandler);\ngetData(initMapMarkers);\n\nexport {resetMainMarkerCoordinates, MAIN_MARKER_START_COORDINATES, concatenateCoordinates, resetMapState}\n","import {getAlertPopup} from './util.js'\n\nconst checkResponse = (response) => {\n  if (response.ok) {\n    return response.json()\n  }\n  throw new Error(response.status + ' ' + response.statusText);\n}\n\nconst getData = (onSuccess) => {\n  fetch('https://22.javascript.pages.academy/keksobooking/data')\n    .then(checkResponse)\n    .then((advertisements) => {\n      onSuccess(advertisements)\n    })\n    .catch(() => {\n      getAlertPopup('Ошибка загрузки данных');\n    })\n}\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch('https://22.javascript.pages.academy/keksobooking',\n    {\n      method: 'POST',\n      body,\n    })\n    .then((response) => {\n      response.ok ? onSuccess() : onFail();\n    })\n    .catch(() => {\n      onFail()\n    })\n}\n\nexport {getData, sendData}\n","const FILE_EXTENSIONS = ['jpg', 'png', 'jpeg']\n\nconst checkFileExtension = (fileName, extensions) => {\n  return extensions.some((extension) => {\n    return fileName.endsWith(extension);\n  })\n}\n\nconst previewHandler = (previewElement) => {\n  return function() {\n    const file = this.files[0];\n    const isCorrectExtension = checkFileExtension(file.name.toLowerCase(), FILE_EXTENSIONS);\n    const isImg = previewElement.tagName === 'IMG';\n    // const isDiv = previewElement.tagName === 'DIV'\n\n    if (isCorrectExtension) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', () => {\n        isImg ?\n          previewElement.src = reader.result :\n          previewElement.style.backgroundImage = `url(${reader.result})`;\n      })\n\n      reader.readAsDataURL(file);\n    }\n  }\n}\n\nexport {previewHandler}\n","import {sendData} from './server-interaction.js'\nimport {resetMainMarkerCoordinates, MAIN_MARKER_START_COORDINATES, concatenateCoordinates, resetMapState} from './map.js'\nimport {previewHandler} from './preview-handler.js'\nimport {resetFilters} from './filter.js'\nconst MinPrices = {\n  BUNGALOW: 0,\n  FLAT: 1000,\n  HOUSE: 5000,\n  PALACE: 10000,\n};\n\nconst form = document.querySelector('.ad-form');\nconst housingType = form.querySelector('#type');\nconst housingPrice = form.querySelector('#price');\nconst timeField = form.querySelector('.ad-form__element--time');\nconst checkinTime = form.querySelector('#timein');\nconst checkoutTime = form.querySelector('#timeout');\nconst roomNumber = form.querySelector('#room_number');\nconst capacity = form.querySelector('#capacity');\nconst address = form.querySelector('#address');\nconst errorMessage = document.querySelector('#error').content.querySelector('.error');\nconst successMessage = document.querySelector('#success').content.querySelector('.success');\nconst main = document.querySelector('main');\nconst avatarInput = form.querySelector('.ad-form-header__input');\nconst roomPhotoInput = form.querySelector('.ad-form__input');\nconst avatarPreview = form.querySelector('.ad-form-header__preview > img');\nconst roomPhotoPreview = form.querySelector('.ad-form__photo')\n\nconst minPricesHandler = () => {\n  housingPrice.min = MinPrices[housingType.value.toUpperCase()];\n  housingPrice.placeholder = MinPrices[housingType.value.toUpperCase()];\n}\n\nconst resetMinPrice = () => {\n  housingPrice.min = MinPrices.FLAT;\n  housingPrice.placeholder = MinPrices.FLAT;\n}\n\nconst resetPreview = () => {\n  avatarPreview.src = 'img/muffin-grey.svg';\n  roomPhotoPreview.removeAttribute('style');\n}\n\nconst timeFieldHandler = (evt) => {\n  const time = evt.target.value;\n  checkinTime.value = checkoutTime.value = time;\n}\n\nconst setAccomodationValidity = () => {\n  const capacityValue = +capacity.value;\n  const roomsValue = +roomNumber.value;\n  const firstException = roomsValue === 100 && capacityValue !== 0;\n  const secondException = roomsValue !== 100 && capacityValue === 0;\n\n  if (roomsValue < capacityValue) {\n    roomNumber.setCustomValidity('комнат не может быть меньше чем гостей');\n  } else if (firstException || secondException) {\n    roomNumber.setCustomValidity('100 комнат не доступно бронированию только не для гостей');\n  } else {\n    roomNumber.setCustomValidity('');\n  }\n  roomNumber.reportValidity();\n}\n\nconst roomsHandler = () => {\n  setAccomodationValidity();\n}\n\nconst capacityHandler = () => {\n  setAccomodationValidity();\n}\n\nconst randomPlaceClickHandler = () => {\n  main.removeChild(errorMessage);\n  window.removeEventListener('click', randomPlaceClickHandler);\n}\n\nconst escapeKeydownHandler = (evt) => {\n  if (evt.keyCode === 27) {\n    main.removeChild(errorMessage);\n    window.removeEventListener('keydown', escapeKeydownHandler);\n  }\n}\n\nconst showFailPopup = () => {\n  main.appendChild(errorMessage);\n  window.addEventListener('click', randomPlaceClickHandler);\n  window.addEventListener('keydown', escapeKeydownHandler);\n}\n\nconst showSuccessPopup = () => {\n  main.appendChild(successMessage);\n  setTimeout(() => {main.removeChild(successMessage)}, 1000);\n  form.reset();\n  resetMapState();\n  resetMainMarkerCoordinates();\n  resetFilters();\n  resetMinPrice();\n  resetPreview();\n  address.value = concatenateCoordinates(MAIN_MARKER_START_COORDINATES);\n}\n\nconst submitHandler = (evt) => {\n  evt.preventDefault();\n  const currentFormData = new FormData(evt.target);\n  sendData(showSuccessPopup, showFailPopup, currentFormData);\n}\n\nroomNumber.addEventListener('change', roomsHandler);\ncapacity.addEventListener('change', capacityHandler);\nhousingType.addEventListener('change', minPricesHandler);\ntimeField.addEventListener('change', timeFieldHandler);\navatarInput.addEventListener('change', previewHandler(avatarPreview));\nroomPhotoInput.addEventListener('change', previewHandler(roomPhotoPreview));\nform.addEventListener('submit', submitHandler);\n\n"],"sourceRoot":""}