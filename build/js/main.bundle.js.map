{"version":3,"sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/card.js","webpack://keksobooking/./source/js/form-access.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/server-interaction.js","webpack://keksobooking/./source/js/preview-handler.js","webpack://keksobooking/./source/js/form.js"],"names":["debounce","f","ms","fnCall","apply","this","arguments","clearTimeout","setTimeout","HousingTypeNames","BUNGALOW","FLAT","HOUSE","PALACE","advertisementCardTemplate","document","querySelector","content","setAdvertisementDataSource","element","advertisementData","src","setAdvertisementDataText","textContent","setAdvertisementDataCapacityText","advertisementDataOne","advertisementDataTwo","setAdvertisementDataTimeText","isDataEmpty","Array","isArray","length","setAdvertisementData","callback","classList","add","remove","setAdvertisementConcatenatedData","setAdvertisementDataList","data","appendChild","renderFeatureItems","features","featureItems","createDocumentFragment","forEach","feature","featureElement","createElement","renderPhotoItems","photos","photoItems","photo","photoElement","width","height","alt","formFieldsets","querySelectorAll","mapFilterBox","mapFilters","FORM_DISABLED_CLASS","switchFormAccess","elements","contains","switchAccessClass","disabled","switchElementsDisability","toggleFormState","filters","typeFilter","priceFilter","roomsFilter","guestsFilter","featuresFilters","checkFilters","item","offer","type","offerType","typeFilterValue","value","checkType","price","offerPrice","priceFilterValue","checkPrice","rooms","offerRooms","roomsFilterValue","anyValue","equalValue","toString","checkRooms","guests","offerGuests","guestsFilterValue","checkGuests","offerFeatures","chosenFeatures","checked","push","getChosenFeatures","every","chosenFeature","includes","checkFeatures","filtrationHandler","advertisements","markerCount","cb","filter","slice","bindFiltrationOnChange","debounceHandler","bind","addEventListener","mainMarkerCoordinates","lat","lng","MAIN_MARKER_START_COORDINATES","address","pinSize","pinAnchor","map","L","tileLayer","attribution","mainMarkerPin","icon","iconUrl","iconSize","iconAnchor","ordinaryMarkerPin","mainMarker","marker","draggable","markerGroup","layerGroup","concatenateCoordinates","coordinates","toFixed","addMarkers","clearLayers","advertisement","location","x","y","bindPopup","advertisementCard","cloneNode","avatar","title","adress","capacity","time","description","author","toUpperCase","checkin","checkout","getAdvertisementCard","addTo","onSuccess","on","setView","getLatLng","fetch","then","response","ok","json","Error","status","statusText","catch","message","alertContainer","style","padding","textAlign","color","backgroundColor","position","left","top","transform","zIndex","body","removeChild","getAlertPopup","FILE_EXTENSIONS","previewHandler","previewElement","file","files","isCorrectExtension","fileName","name","toLowerCase","some","extension","endsWith","isImg","tagName","reader","FileReader","result","backgroundImage","readAsDataURL","MinPrices","housingType","housingPrice","timeField","checkinTime","checkoutTime","roomNumber","errorMessage","successMessage","main","avatarInput","roomPhotoInput","avatarPreview","roomPhotoPreview","setAccomodationValidity","capacityValue","roomsValue","firstException","secondException","setCustomValidity","reportValidity","randomPlaceClickHandler","window","removeEventListener","escapeKeydownHandler","evt","keyCode","showFailPopup","showSuccessPopup","reset","setLatLng","min","placeholder","target","preventDefault","currentFormData","FormData","onFail","method","sendData"],"mappings":"mBAAA,MAsCMA,EAAW,CAACC,EAAGC,IACZ,WACL,MAAMC,EAAS,KACbF,EAAEG,MAAMC,KAAMC,YAEhBC,aAAaJ,GACbK,WAAWL,EAAQD,IC3CjBO,EAAmB,CACvBC,SAAU,UACVC,KAAM,WACNC,MAAO,MACPC,OAAQ,UAGJC,EAA4BC,SAASC,cAAc,SAASC,QAAQD,cAAc,UAElFE,EAA6B,CAACC,EAASC,KAC3CD,EAAQE,IAAMD,GAGVE,EAA2B,CAACH,EAASC,KACzCD,EAAQI,YAAcH,GAGlBI,EAAmC,CAACL,EAASM,EAAsBC,KACvEP,EAAQI,YAAcE,EAAuB,eAAiBC,EAAuB,WAGjFC,EAA+B,CAACR,EAASM,EAAsBC,KACnEP,EAAQI,YAAc,eAAiBE,EAAuB,cAAgBC,GAG1EE,EAAeR,IACVA,GAAsBS,MAAMC,QAAQV,KAAuBA,EAAkBW,OAGlFC,EAAuB,CAACb,EAASC,EAAmBa,KACpDL,EAAYR,GACdD,EAAQe,UAAUC,IAAI,WAEtBhB,EAAQe,UAAUE,OAAO,UACzBH,EAASd,EAASC,KAIhBiB,EAAmC,CAAClB,EAASM,EAAsBC,EAAsBO,KACzFL,EAAYH,IAAyBG,EAAYF,GACnDP,EAAQe,UAAUC,IAAI,WAEtBhB,EAAQe,UAAUE,OAAO,UACzBH,EAASd,EAASM,EAAsBC,KAItCY,EAA2B,CAACnB,EAASoB,EAAMN,KAC/Cd,EAAQI,YAAc,GAClBK,EAAYW,GACdpB,EAAQe,UAAUC,IAAI,WAEtBhB,EAAQe,UAAUE,OAAO,UACzBjB,EAAQqB,YAAYP,EAASM,MAI3BE,EAAsBC,IAC1B,MAAMC,EAAe5B,SAAS6B,yBAO9B,OANAF,EAASG,SAASC,IAChB,MAAMC,EAAiBhC,SAASiC,cAAc,MAC9CD,EAAeb,UAAUC,IAAI,kBAC7BY,EAAeb,UAAUC,IAAI,mBAA0BW,GACvDH,EAAaH,YAAYO,MAEpBJ,GAGHM,EAAoBC,IACxB,MAAMC,EAAapC,SAAS6B,yBAU5B,OATAM,EAAOL,SAASO,IACd,MAAMC,EAAetC,SAASiC,cAAc,OAC5CK,EAAanB,UAAUC,IAAI,iBAC3BkB,EAAahC,IAAM+B,EACnBC,EAAaC,MAAQ,GACrBD,EAAaE,OAAS,GACtBF,EAAaG,IAAM,mBACnBL,EAAWX,YAAYa,MAElBF,GChFH,EAAOpC,SAASC,cAAc,YAC9ByC,EAAgB,EAAKC,iBAAiB,oBAAqB,mBAC3DC,EAAe5C,SAASC,cAAc,iBACtC4C,EAAaD,EAAaD,iBAAiB,eAAgB,kBAC3DG,EAAsB,oBActBC,EAAmB,CAAC3C,EAAS4C,KAZT,CAAC5C,IACxBA,EAAQe,UAAU8B,SAASH,GAC1B1C,EAAQe,UAAUE,OAAOyB,GACzB1C,EAAQe,UAAUC,IAAI0B,IAUxBI,CAAkB9C,GAPa,CAAC4C,IAChCA,EAASlB,SAAS1B,IAChBA,EAAQ+C,UAAY/C,EAAQ+C,aAM9BC,CAAyBJ,IAGrBK,EAAkB,KACtBN,EAAiB,EAAML,GACvBK,EAAiBH,EAAcC,IAGjCQ,IC3BA,MA+BMC,EAAUtD,SAASC,cAAc,iBACjCsD,EAAaD,EAAQrD,cAAc,iBACnCuD,EAAcF,EAAQrD,cAAc,kBACpCwD,EAAcH,EAAQrD,cAAc,kBACpCyD,EAAgBJ,EAAQrD,cAAc,mBACtC0D,EAAkBL,EAAQX,iBAAiB,kBA0D3CiB,EAAgBC,GAxDJ,GAAEC,OAAQC,KAAOC,OACjC,MAAMC,EAAkBV,EAAWW,MAInC,MAtCK,QAmCYD,GACED,IAAcC,GAsD1BE,CAAUN,IAjDA,GAAEC,OAAQM,MAAQC,OACnC,MAAMC,EAAmBd,EAAYU,MAQrC,MA3CK,QAqCYI,GApCZ,QAqCYA,GAA8CD,EAjD1D,KAaG,WAqCYC,GACnBD,GAnDI,KAmD6BA,EAlD1B,KAaF,SAsCYC,GAA+CD,GAnDzD,KA8FRE,CAAWV,IAtCM,GAAEC,OAAQU,MAAOC,OAClC,MAAMC,EAAmBjB,EAAYS,MAE/BS,EA3CD,QA2CYD,EACXE,EAAaF,IAAqBD,EAAWI,WAEnD,OAAOF,GAAYC,GAiCnBE,CAAWjB,IA9BO,GAAEC,OAAQiB,OAAQC,OACpC,MAAMC,EAAoBvB,EAAaQ,MAEjCS,EA9CD,QA8CYM,EACXL,EAAaK,IAAsBD,EAAYH,WAErD,OAAOF,GAAYC,GAyBnBM,CAAYrB,IAZQ,GAAEC,OAAQnC,SAAUwD,MAVhB,MACxB,MAAMC,EAAiB,GAMvB,OALAzB,EAAgB7B,SAASC,IACnBA,EAAQsD,SACVD,EAAeE,KAAKvD,EAAQmC,UAGzBkB,GAIgBG,GAEDC,OAAOC,GACpBN,EAAcO,SAASD,KAShCE,CAAc9B,GAGV+B,EAAoB,CAACC,EAAgBC,EAAaC,KAEtDA,EAD+BF,EAAeG,OAAO,GAAgBC,MAAM,EAAGH,KAI1EI,EAAyB,CAACL,EAAgBC,EAAaC,KAC3D,MAAMI,EAAkBlH,EACtB2G,EAAkBQ,UAAK,EAAMP,EAAgBC,EAAaC,GAhFrC,KAmFvBzC,EAAQ+C,iBAAiB,SAAUF,ICxGrC,IAAIG,EAAwB,CAC1BC,IAAK,SACLC,IAAK,WAEP,MAAMC,EAAgC,CACpCF,IAAK,SACLC,IAAK,WAIDE,EAAU1G,SAASC,cAAc,YAGjC0G,EAAU,CAAC,GAAI,IACfC,EAAY,CAACD,EAAQ,GAAK,EAAGA,EAAQ,IAErCE,EAAMC,EAAED,IAAI,cACZE,EAAYD,EAAEC,UAClB,4DACA,CACEC,YAAa,4FAGXC,EAAgBH,EAAEI,KAAK,CAC3BC,QAAS,sBACTC,SAAUT,EACVU,WAAYT,IAERU,EAAoBR,EAAEI,KAAK,CAC/BC,QAAS,iBACTC,SAAUT,EACVU,WAAYT,IAERW,EAAaT,EAAEU,OACnBlB,EACA,CACEmB,WAAW,EACXP,KAAMD,IAGJS,EAAcZ,EAAEa,WAAW,IAE3BC,EAA0BC,IAC9BA,EAAYtB,IAAMsB,EAAYtB,IAAIuB,QA/BP,GAgC3BD,EAAYrB,IAAMqB,EAAYrB,IAAIsB,QAhCP,GAiCpB,GAAGD,EAAYtB,OAAOsB,EAAYrB,OAYrCuB,EAAclC,IAClB6B,EAAYM,cACZnC,EAAe/D,SAASmG,IACtB,IAAKC,UAAW3B,IAAK4B,EAAG3B,IAAK4B,IAAMH,EACnC,MAAMT,EAASV,EAAEU,OACf,CACEjB,IAAK4B,EACL3B,IAAK4B,GAEP,CACEX,WAAW,EACXP,KAAMI,IAGVE,EAAOa,UHGkB,CAACJ,IAC5B,MAAMK,EAAoBvI,EAA0BwI,WAAU,GACxDC,EAASF,EAAkBrI,cAAc,kBACzCwI,EAAQH,EAAkBrI,cAAc,iBACxCyI,EAASJ,EAAkBrI,cAAc,yBACzCmE,EAAQkE,EAAkBrI,cAAc,uBACxC8D,EAAOuE,EAAkBrI,cAAc,gBACvC0I,EAAWL,EAAkBrI,cAAc,0BAC3C2I,EAAON,EAAkBrI,cAAc,sBACvC0B,EAAW2G,EAAkBrI,cAAc,oBAC3C4I,EAAcP,EAAkBrI,cAAc,uBAC9CkC,EAASmG,EAAkBrI,cAAc,kBAa/C,OAXAgB,EAAqBuH,EAAQP,EAAca,OAAON,OAAQrI,GAC1Dc,EAAqBwH,EAAOR,EAAcnE,MAAM2E,MAAOlI,GACvDU,EAAqByH,EAAQT,EAAcnE,MAAM+E,YAAatI,GAC9DU,EAAqBmD,EAAO6D,EAAcnE,MAAMM,MAAO7D,GACvDU,EAAqB8C,EAAMrE,EAAiBuI,EAAcnE,MAAMC,KAAKgF,eAAgBxI,GACrFe,EAAiCqH,EAAUV,EAAcnE,MAAMU,MAAOyD,EAAcnE,MAAMiB,OAAQtE,GAClGa,EAAiCsH,EAAMX,EAAcnE,MAAMkF,QAASf,EAAcnE,MAAMmF,SAAUrI,GAClGW,EAAyBI,EAAUsG,EAAcnE,MAAMnC,SAAUD,GACjET,EAAqB4H,EAAaZ,EAAcnE,MAAM+E,YAAatI,GACnEgB,EAAyBY,EAAQ8F,EAAcnE,MAAM3B,OAAQD,GAEtDoG,GG3BYY,CAAqBjB,IACtCT,EAAO2B,MAAMzB,OCvED,IAAC0B,EDgFjBvC,EAAIwC,GAAG,OAAQ,GAAgBC,QArFL,CACxB/C,IAAK,SACLC,IAAK,WAac,GAuErBO,EAAUoC,MAAMtC,GAChBU,EAAW4B,MAAMtC,GACjBa,EAAYyB,MAAMtC,GAClBH,EAAQxC,MAAQ0D,EAAuBtB,GACvCiB,EAAW8B,GAAG,WAtCS,KACrB/C,EAAwBiB,EAAWgC,YACnC7C,EAAQxC,MAAQ0D,EAAuBtB,MCjDxB8C,ED2EOvD,IACtBkC,EAAWlC,GACXK,EAAuBL,EAtEH,GAsEkCkC,IC5EtDyB,MAAM,yDACHC,MAVkBC,IACrB,GAAIA,EAASC,GACX,OAAOD,EAASE,OAEhB,MAAM,IAAIC,MAAMH,EAASI,OAAS,IAAMJ,EAASK,eAOhDN,MAAM5D,IACLuD,EAAUvD,MAEXmE,OAAM,KLKW,CAACC,IACrB,MAAMC,EAAiBlK,SAASiC,cAAc,OAC9CiI,EAAeC,MAAM5H,MAAQ,QAC7B2H,EAAeC,MAAMC,QAAU,OAC/BF,EAAeC,MAAME,UAAY,SACjCH,EAAeC,MAAMG,MAAQ,QAC7BJ,EAAeC,MAAMI,gBAAkB,OACvCL,EAAeC,MAAMK,SAAW,QAChCN,EAAeC,MAAMM,KAAO,MAC5BP,EAAeC,MAAMO,IAAM,MAC3BR,EAAeC,MAAMQ,UAAY,wBACjCT,EAAeC,MAAMS,OAAS,MAC9BV,EAAe1J,YKhBG,yBLiBlBR,SAAS6K,KAAKpJ,YAAYyI,GAC1BzK,YAAW,KAAOO,SAAS6K,KAAKC,YAAYZ,KAAkB,MKlB1Da,MCjBN,MAAMC,EAAkB,CAAC,MAAO,MAAO,QAQjCC,EAAkBC,GACf,WACL,MAAMC,EAAO7L,KAAK8L,MAAM,GAClBC,GATkBC,EASsBH,EAAKI,KAAKC,cAAeR,EARvDS,MAAMC,GACfJ,EAASK,SAASD,MAFF,IAACJ,EAUxB,MAAMM,EAAmC,QAA3BV,EAAeW,QAG7B,GAAIR,EAAoB,CACtB,MAAMS,EAAS,IAAIC,WAEnBD,EAAOzF,iBAAiB,QAAQ,KAC9BuF,EACEV,EAAe5K,IAAMwL,EAAOE,OAC5Bd,EAAef,MAAM8B,gBAAkB,OAAOH,EAAOE,aAGzDF,EAAOI,cAAcf,KCrBrBgB,EAAY,CAChBxM,SAAU,EACVC,KAAM,IACNC,MAAO,IACPC,OAAQ,KAGJ,EAAOE,SAASC,cAAc,YAC9BmM,EAAc,EAAKnM,cAAc,SACjCoM,EAAe,EAAKpM,cAAc,UAClCqM,EAAY,EAAKrM,cAAc,2BAC/BsM,EAAc,EAAKtM,cAAc,WACjCuM,EAAe,EAAKvM,cAAc,YAClCwM,EAAa,EAAKxM,cAAc,gBAChC0I,GAAW,EAAK1I,cAAc,aAC9B,GAAU,EAAKA,cAAc,YAC7ByM,GAAe1M,SAASC,cAAc,UAAUC,QAAQD,cAAc,UACtE0M,GAAiB3M,SAASC,cAAc,YAAYC,QAAQD,cAAc,YAC1E2M,GAAO5M,SAASC,cAAc,QAC9B4M,GAAc,EAAK5M,cAAc,0BACjC6M,GAAiB,EAAK7M,cAAc,mBACpC8M,GAAgB,EAAK9M,cAAc,kCACnC+M,GAAmB,EAAK/M,cAAc,mBAYtCgN,GAA0B,KAC9B,MAAMC,GAAiBvE,GAASzE,MAC1BiJ,GAAcV,EAAWvI,MACzBkJ,EAAgC,MAAfD,GAAwC,IAAlBD,EACvCG,EAAiC,MAAfF,GAAwC,IAAlBD,EAE1CC,EAAaD,EACfT,EAAWa,kBAAkB,0CACpBF,GAAkBC,EAC3BZ,EAAWa,kBAAkB,4DAE7Bb,EAAWa,kBAAkB,IAE/Bb,EAAWc,kBAWPC,GAA0B,KAC9BZ,GAAK9B,YAAY4B,IACjBe,OAAOC,oBAAoB,QAASF,KAGhCG,GAAwBC,IACR,KAAhBA,EAAIC,UACNjB,GAAK9B,YAAY4B,IACjBe,OAAOC,oBAAoB,UAAWC,MAIpCG,GAAgB,KACpBlB,GAAKnL,YAAYiL,IACjBe,OAAOpH,iBAAiB,QAASmH,IACjCC,OAAOpH,iBAAiB,UAAWsH,KAG/BI,GAAmB,KACvBnB,GAAKnL,YAAYkL,IACjBlN,YAAW,KAAOmN,GAAK9B,YAAY6B,MAAkB,KACrD,EAAKqB,QHnBLzG,EAAW0G,UAAUxH,GGqBrB,GAAQvC,MAAQ0D,EAAuBnB,IASzCgG,EAAWpG,iBAAiB,UAxCP,KACnB4G,QAwCFtE,GAAStC,iBAAiB,UArCF,KACtB4G,QAqCFb,EAAY/F,iBAAiB,UApEJ,KACvBgG,EAAa6B,IAAM/B,EAAUC,EAAYlI,MAAM6E,eAC/CsD,EAAa8B,YAAchC,EAAUC,EAAYlI,MAAM6E,kBAmEzDuD,EAAUjG,iBAAiB,UAhEDuH,IACxB,MAAMhF,EAAOgF,EAAIQ,OAAOlK,MACxBqI,EAAYrI,MAAQsI,EAAatI,MAAQ0E,KA+D3CiE,GAAYxG,iBAAiB,SAAU4E,EAAe8B,KACtDD,GAAezG,iBAAiB,SAAU4E,EAAe+B,KACzD,EAAK3G,iBAAiB,UAZCuH,IACrBA,EAAIS,iBACJ,MAAMC,EAAkB,IAAIC,SAASX,EAAIQ,QFpE1B,EAAChF,EAAWoF,EAAQ3D,KACnCrB,MAAM,mDACJ,CACEiF,OAAQ,OACR5D,SAEDpB,MAAMC,IACLA,EAASC,GAAKP,IAAcoF,OAE7BxE,OAAM,KACLwE,QE2DJE,CAASX,GAAkBD,GAAeQ,O","file":"main.bundle.js","sourcesContent":["const getCorrectRange = (min, max) => {\n  if (min >= 0 && max > min) {\n    return true;\n  }\n  alert('Функций getRandomNumber получила недопустимое значение')\n  return false;\n};\n\nconst getRandomNumber = (min, max) => {\n  if (getCorrectRange(min, max)) {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n  }\n};\n\nconst getRandomFloat = (min, max, afterComma) => {\n  if (getCorrectRange(min, max)) {\n    let randomFloat = Math.random() * (max - min + (0.1 ** afterComma)) + min;\n    return Math.floor(randomFloat * 10 ** afterComma) / 10 ** afterComma;\n  }\n};\n\nconst getAlertPopup = (message) => {\n  const alertContainer = document.createElement('div')\n  alertContainer.style.width = '300px';\n  alertContainer.style.padding = '20px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.color = 'white';\n  alertContainer.style.backgroundColor = '#ccc';\n  alertContainer.style.position = 'fixed';\n  alertContainer.style.left = '50%'\n  alertContainer.style.top = '50%'\n  alertContainer.style.transform = 'translate(-50%, -50%)';\n  alertContainer.style.zIndex = '666';\n  alertContainer.textContent = message;\n  document.body.appendChild(alertContainer);\n  setTimeout(() => {document.body.removeChild(alertContainer)}, 2000);\n}\n\nconst debounce = (f, ms) => {\n  return function() {\n    const fnCall = () => {\n      f.apply(this, arguments);\n    };\n    clearTimeout(fnCall);\n    setTimeout(fnCall, ms);\n  };\n}\n\nexport {getRandomFloat, getRandomNumber, getAlertPopup, debounce};\n","import {getAdvertisement} from './data.js';\nconst HousingTypeNames = {\n  BUNGALOW: 'Бунгало',\n  FLAT: 'Квартира',\n  HOUSE: 'Дом',\n  PALACE: 'Дворец',\n};\n\nconst advertisementCardTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst setAdvertisementDataSource = (element, advertisementData) => {\n  element.src = advertisementData;\n}\n\nconst setAdvertisementDataText = (element, advertisementData) => {\n  element.textContent = advertisementData;\n}\n\nconst setAdvertisementDataCapacityText = (element, advertisementDataOne, advertisementDataTwo) => {\n  element.textContent = advertisementDataOne + ' комнат для ' + advertisementDataTwo + ' гостей';\n}\n\nconst setAdvertisementDataTimeText = (element, advertisementDataOne, advertisementDataTwo) => {\n  element.textContent = 'Заезд после ' + advertisementDataOne + ', Выезд до ' + advertisementDataTwo;\n}\n\nconst isDataEmpty = (advertisementData) => {\n  return (!advertisementData || (Array.isArray(advertisementData) && !advertisementData.length));\n}\n\nconst setAdvertisementData = (element, advertisementData, callback) => {\n  if (isDataEmpty(advertisementData)) {\n    element.classList.add('hidden');\n  } else {\n    element.classList.remove('hidden');\n    callback(element, advertisementData);\n  }\n}\n\nconst setAdvertisementConcatenatedData = (element, advertisementDataOne, advertisementDataTwo, callback) => {\n  if (isDataEmpty(advertisementDataOne) || isDataEmpty(advertisementDataTwo)) {\n    element.classList.add('hidden');\n  } else {\n    element.classList.remove('hidden');\n    callback(element, advertisementDataOne, advertisementDataTwo);\n  }\n}\n\nconst setAdvertisementDataList = (element, data, callback) => {\n  element.textContent = '';\n  if (isDataEmpty(data)) {\n    element.classList.add('hidden');\n  } else {\n    element.classList.remove('hidden');\n    element.appendChild(callback(data));\n  }\n}\n\nconst renderFeatureItems = (features) => {\n  const featureItems = document.createDocumentFragment() ;\n  features.forEach((feature) => {\n    const featureElement = document.createElement('li');\n    featureElement.classList.add('popup__feature');\n    featureElement.classList.add('popup__feature' + '--' + feature);\n    featureItems.appendChild(featureElement);\n  });\n  return featureItems;\n}\n\nconst renderPhotoItems = (photos) => {\n  const photoItems = document.createDocumentFragment();\n  photos.forEach((photo) => {\n    const photoElement = document.createElement('img');\n    photoElement.classList.add('.popup__photo');\n    photoElement.src = photo;\n    photoElement.width = 45;\n    photoElement.height = 45;\n    photoElement.alt = 'Фотография жилья';\n    photoItems.appendChild(photoElement);\n  });\n  return photoItems;\n}\n\nconst getAdvertisementCard = (advertisement) => {\n  const advertisementCard = advertisementCardTemplate.cloneNode(true);\n  const avatar = advertisementCard.querySelector('.popup__avatar');\n  const title = advertisementCard.querySelector('.popup__title');\n  const adress = advertisementCard.querySelector('.popup__text--address');\n  const price = advertisementCard.querySelector('.popup__text--price');\n  const type = advertisementCard.querySelector('.popup__type');\n  const capacity = advertisementCard.querySelector('.popup__text--capacity');\n  const time = advertisementCard.querySelector('.popup__text--time');\n  const features = advertisementCard.querySelector('.popup__features');\n  const description = advertisementCard.querySelector('.popup__description');\n  const photos = advertisementCard.querySelector('.popup__photos');\n\n  setAdvertisementData(avatar, advertisement.author.avatar, setAdvertisementDataSource);\n  setAdvertisementData(title, advertisement.offer.title, setAdvertisementDataText);\n  setAdvertisementData(adress, advertisement.offer.description, setAdvertisementDataText);\n  setAdvertisementData(price, advertisement.offer.price, setAdvertisementDataText);\n  setAdvertisementData(type, HousingTypeNames[advertisement.offer.type.toUpperCase()], setAdvertisementDataText);\n  setAdvertisementConcatenatedData(capacity, advertisement.offer.rooms, advertisement.offer.guests, setAdvertisementDataCapacityText);\n  setAdvertisementConcatenatedData(time, advertisement.offer.checkin, advertisement.offer.checkout, setAdvertisementDataTimeText);\n  setAdvertisementDataList(features, advertisement.offer.features, renderFeatureItems);\n  setAdvertisementData(description, advertisement.offer.description, setAdvertisementDataText);\n  setAdvertisementDataList(photos, advertisement.offer.photos, renderPhotoItems);\n\n  return advertisementCard;\n}\n\nexport {getAdvertisementCard, getAdvertisement}\n","const form = document.querySelector('.ad-form');\nconst formFieldsets = form.querySelectorAll('.ad-form__element', '.ad-form-header');\nconst mapFilterBox = document.querySelector('.map__filters');\nconst mapFilters = mapFilterBox.querySelectorAll('.map__filter', '.map__features');\nconst FORM_DISABLED_CLASS = 'ad-form--disabled';\n\nconst switchAccessClass = (element) => {\n  (element.classList.contains(FORM_DISABLED_CLASS)) ?\n    element.classList.remove(FORM_DISABLED_CLASS) :\n    element.classList.add(FORM_DISABLED_CLASS);\n}\n\nconst switchElementsDisability = (elements) => {\n  elements.forEach((element) => {\n    element.disabled = !element.disabled;\n  })\n}\n\nconst switchFormAccess = (element, elements) => {\n  switchAccessClass(element);\n  switchElementsDisability(elements);\n}\n\nconst toggleFormState = () => {\n  switchFormAccess(form, formFieldsets);\n  switchFormAccess(mapFilterBox, mapFilters);\n}\n\ntoggleFormState();\n\nexport {toggleFormState};\n","import {debounce} from './util.js'\nconst PricePoints = {\n  LOW: 10000,\n  MIDDLE: 50000,\n};\nconst TypeFilterValues = {\n  ANY: 'any',\n  PALACE: 'palace',\n  FLAT: 'flat',\n  HOUSE: 'house',\n  BUNGALOW: 'bungalow',\n};\nconst PriceFilterValues = {\n  ANY: 'any',\n  LOW: 'low',\n  MIDDLE: 'middle',\n  HIGH: 'high',\n};\nconst RoomsFilterValues = {\n  ANY: 'any',\n  ONE: '1',\n  TWO: '2',\n  THREE: '3',\n};\nconst GuestsFilterValues = {\n  ANY: 'any',\n  ONE: '1',\n  TWO: '2',\n  NOT_FOR_GUESTS: '0',\n};\nconst DEBOUNCE_TIMEOUT = 500;\n\nconst filters = document.querySelector('.map__filters');\nconst typeFilter = filters.querySelector('#housing-type');\nconst priceFilter = filters.querySelector('#housing-price');\nconst roomsFilter = filters.querySelector('#housing-rooms');\nconst guestsFilter  = filters.querySelector('#housing-guests');\nconst featuresFilters = filters.querySelectorAll('.map__checkbox');\n\nconst checkType = ({offer: {type : offerType}}) => {\n  const typeFilterValue = typeFilter.value;\n  const anyValue = typeFilterValue === TypeFilterValues.ANY;\n  const equalValue = offerType === typeFilterValue;\n\n  return anyValue || equalValue;\n}\n\nconst checkPrice = ({offer: {price : offerPrice}}) => {\n  const priceFilterValue = priceFilter.value;\n\n  const anyPrice = priceFilterValue === PriceFilterValues.ANY;\n  const lowPrice = priceFilterValue === PriceFilterValues.LOW && offerPrice < PricePoints.LOW;\n  const middlePrice = priceFilterValue === PriceFilterValues.MIDDLE &&\n  (offerPrice >= PricePoints.LOW && offerPrice < PricePoints.MIDDLE);\n  const highPrice = priceFilterValue === PriceFilterValues.HIGH && offerPrice >= PricePoints.MIDDLE;\n\n  return anyPrice || lowPrice || middlePrice || highPrice;\n}\n\nconst checkRooms = ({offer: {rooms: offerRooms}}) => {\n  const roomsFilterValue = roomsFilter.value;\n\n  const anyValue = roomsFilterValue === RoomsFilterValues.ANY;\n  const equalValue = roomsFilterValue === offerRooms.toString();\n\n  return anyValue || equalValue;\n}\n\nconst checkGuests = ({offer: {guests: offerGuests}}) => {\n  const guestsFilterValue = guestsFilter.value;\n\n  const anyValue = guestsFilterValue === GuestsFilterValues.ANY\n  const equalValue = guestsFilterValue === offerGuests.toString()\n\n  return anyValue || equalValue;\n}\n\nconst getChosenFeatures = () => {\n  const chosenFeatures = []\n  featuresFilters.forEach((feature) => {\n    if (feature.checked) {\n      chosenFeatures.push(feature.value)\n    }\n  })\n  return chosenFeatures;\n}\n\nconst checkFeatures = ({offer: {features: offerFeatures}}) => {\n  const chosenFeatures = getChosenFeatures()\n\n  return chosenFeatures.every((chosenFeature) => {\n    return offerFeatures.includes(chosenFeature);\n  });\n};\n\nconst checkFilters = (item) => {\n  return checkType(item) &&\n  checkPrice(item) &&\n  checkRooms(item) &&\n  checkGuests(item) &&\n  checkFeatures(item);\n}\n\nconst filtrationHandler = (advertisements, markerCount, cb) => {\n  const filteredAdvertisements = advertisements.filter((checkFilters)).slice(0, markerCount);\n  cb(filteredAdvertisements);\n}\n\nconst bindFiltrationOnChange = (advertisements, markerCount, cb) => {\n  const debounceHandler = debounce(\n    filtrationHandler.bind(this, advertisements, markerCount, cb),\n    DEBOUNCE_TIMEOUT);\n\n  filters.addEventListener('change', debounceHandler);\n}\n\nexport {bindFiltrationOnChange}\n","/* global L:readonly */\nimport {getAdvertisementCard} from './card.js';\nimport {toggleFormState as mapLoadHandler} from './form-access.js';\nimport {getData} from './server-interaction.js';\nimport {bindFiltrationOnChange} from './filter.js';\nconst TOKIO_COORDINATES = {\n  lat: 35.68742,\n  lng: 139.77356,\n};\nlet mainMarkerCoordinates = {\n  lat: 35.68742,\n  lng: 139.77356,\n};\nconst MAIN_MARKER_START_COORDINATES = {\n  lat: 35.68742,\n  lng: 139.77356,\n};\nconst MARKERS_COUNT = 10;\n\nconst address = document.querySelector('#address');\nconst initialScale = 9;\nconst coordinatesPrecision = 5;\nconst pinSize = [50, 50];\nconst pinAnchor = [pinSize[0] / 2, pinSize[1]];\n\nconst map = L.map('map-canvas');\nconst tileLayer = L.tileLayer(/*'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'*/\n  'https://tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n);\nconst mainMarkerPin = L.icon({\n  iconUrl: '../img/main-pin.svg',\n  iconSize: pinSize,\n  iconAnchor: pinAnchor,\n});\nconst ordinaryMarkerPin = L.icon({\n  iconUrl: '../img/pin.svg',\n  iconSize: pinSize,\n  iconAnchor: pinAnchor,\n});\nconst mainMarker = L.marker(\n  mainMarkerCoordinates,\n  {\n    draggable: true,\n    icon: mainMarkerPin,\n  },\n);\nconst markerGroup = L.layerGroup([]);\n\nconst concatenateCoordinates = (coordinates) => {\n  coordinates.lat = coordinates.lat.toFixed(coordinatesPrecision);\n  coordinates.lng = coordinates.lng.toFixed(coordinatesPrecision);\n  return `${coordinates.lat} ${coordinates.lng}`;\n}\n\nconst addressHandler = () => {\n  mainMarkerCoordinates = mainMarker.getLatLng();\n  address.value = concatenateCoordinates(mainMarkerCoordinates);\n}\n\nconst resetMainMarkerCoordinates = () => {\n  mainMarker.setLatLng(MAIN_MARKER_START_COORDINATES);\n}\n\nconst addMarkers = (advertisements) => {\n  markerGroup.clearLayers()\n  advertisements.forEach((advertisement) => {\n    let {location: {lat: x, lng: y}} = advertisement\n    const marker = L.marker(\n      {\n        lat: x,\n        lng: y,\n      },\n      {\n        draggable: false,\n        icon: ordinaryMarkerPin,\n      },\n    );\n    marker.bindPopup(getAdvertisementCard(advertisement));\n    marker.addTo(markerGroup);\n  })\n}\n\nconst initMapMarkers = (advertisements) => {\n  addMarkers(advertisements)\n  bindFiltrationOnChange(advertisements, MARKERS_COUNT, addMarkers)\n}\n\nmap.on('load', mapLoadHandler).setView(TOKIO_COORDINATES, initialScale);\ntileLayer.addTo(map);\nmainMarker.addTo(map);\nmarkerGroup.addTo(map)\naddress.value = concatenateCoordinates(mainMarkerCoordinates);\nmainMarker.on('moveend', addressHandler);\ngetData(initMapMarkers);\n\nexport {resetMainMarkerCoordinates, MAIN_MARKER_START_COORDINATES, concatenateCoordinates}\n","import {getAlertPopup} from './util.js'\n\nconst checkResponse = (response) => {\n  if (response.ok) {\n    return response.json()\n  } else {\n    throw new Error(response.status + ' ' + response.statusText);\n  }\n}\n\nconst getData = (onSuccess) => {\n  fetch('https://22.javascript.pages.academy/keksobooking/data')\n    .then(checkResponse)\n    .then((advertisements) => {\n      onSuccess(advertisements)\n    })\n    .catch(() => {\n      getAlertPopup('Ошибка загрузки данных');\n    })\n}\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch('https://22.javascript.pages.academy/keksobooking',\n    {\n      method: 'POST',\n      body,\n    })\n    .then((response) => {\n      response.ok ? onSuccess() : onFail();\n    })\n    .catch(() => {\n      onFail()\n    })\n}\n\nexport {getData, sendData}\n","const FILE_EXTENSIONS = ['jpg', 'png', 'jpeg']\n\nconst checkFileExtension = (fileName, extensions) => {\n  return extensions.some((extension) => {\n    return fileName.endsWith(extension);\n  })\n}\n\nconst previewHandler = (previewElement) => {\n  return function() {\n    const file = this.files[0];\n    const isCorrectExtension = checkFileExtension(file.name.toLowerCase(), FILE_EXTENSIONS);\n    const isImg = previewElement.tagName === 'IMG';\n    // const isDiv = previewElement.tagName === 'DIV'\n\n    if (isCorrectExtension) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', () => {\n        isImg ?\n          previewElement.src = reader.result :\n          previewElement.style.backgroundImage = `url(${reader.result})`;\n      })\n\n      reader.readAsDataURL(file);\n    }\n  }\n}\n\nexport {previewHandler}\n","import {sendData} from './server-interaction.js'\nimport {resetMainMarkerCoordinates, MAIN_MARKER_START_COORDINATES, concatenateCoordinates} from './map.js'\nimport {previewHandler} from './preview-handler.js'\nconst MinPrices = {\n  BUNGALOW: 0,\n  FLAT: 1000,\n  HOUSE: 5000,\n  PALACE: 10000,\n};\n\nconst form = document.querySelector('.ad-form');\nconst housingType = form.querySelector('#type');\nconst housingPrice = form.querySelector('#price');\nconst timeField = form.querySelector('.ad-form__element--time');\nconst checkinTime = form.querySelector('#timein');\nconst checkoutTime = form.querySelector('#timeout');\nconst roomNumber = form.querySelector('#room_number');\nconst capacity = form.querySelector('#capacity');\nconst address = form.querySelector('#address');\nconst errorMessage = document.querySelector('#error').content.querySelector('.error');\nconst successMessage = document.querySelector('#success').content.querySelector('.success');\nconst main = document.querySelector('main');\nconst avatarInput = form.querySelector('.ad-form-header__input');\nconst roomPhotoInput = form.querySelector('.ad-form__input');\nconst avatarPreview = form.querySelector('.ad-form-header__preview > img');\nconst roomPhotoPreview = form.querySelector('.ad-form__photo')\n\nconst minPricesHandler = () => {\n  housingPrice.min = MinPrices[housingType.value.toUpperCase()];\n  housingPrice.placeholder = MinPrices[housingType.value.toUpperCase()];\n}\n\nconst timeFieldHandler = (evt) => {\n  const time = evt.target.value;\n  checkinTime.value = checkoutTime.value = time;\n}\n\nconst setAccomodationValidity = () => {\n  const capacityValue = +capacity.value;\n  const roomsValue = +roomNumber.value;\n  const firstException = roomsValue === 100 && capacityValue !== 0;\n  const secondException = roomsValue !== 100 && capacityValue === 0;\n\n  if (roomsValue < capacityValue) {\n    roomNumber.setCustomValidity('комнат не может быть меньше чем гостей');\n  } else if (firstException || secondException) {\n    roomNumber.setCustomValidity('100 комнат не доступно бронированию только не для гостей');\n  } else {\n    roomNumber.setCustomValidity('');\n  }\n  roomNumber.reportValidity();\n}\n\nconst roomsHandler = () => {\n  setAccomodationValidity();\n}\n\nconst capacityHandler = () => {\n  setAccomodationValidity();\n}\n\nconst randomPlaceClickHandler = () => {\n  main.removeChild(errorMessage);\n  window.removeEventListener('click', randomPlaceClickHandler);\n}\n\nconst escapeKeydownHandler = (evt) => {\n  if (evt.keyCode === 27) {\n    main.removeChild(errorMessage);\n    window.removeEventListener('keydown', escapeKeydownHandler);\n  }\n}\n\nconst showFailPopup = () => {\n  main.appendChild(errorMessage);\n  window.addEventListener('click', randomPlaceClickHandler);\n  window.addEventListener('keydown', escapeKeydownHandler);\n}\n\nconst showSuccessPopup = () => {\n  main.appendChild(successMessage);\n  setTimeout(() => {main.removeChild(successMessage)}, 1000);\n  form.reset();\n  resetMainMarkerCoordinates();\n  address.value = concatenateCoordinates(MAIN_MARKER_START_COORDINATES);\n}\n\nconst submitHandler = (evt) => {\n  evt.preventDefault();\n  const currentFormData = new FormData(evt.target);\n  sendData(showSuccessPopup, showFailPopup, currentFormData);\n}\n\nroomNumber.addEventListener('change', roomsHandler);\ncapacity.addEventListener('change', capacityHandler);\nhousingType.addEventListener('change', minPricesHandler);\ntimeField.addEventListener('change', timeFieldHandler);\navatarInput.addEventListener('change', previewHandler(avatarPreview));\nroomPhotoInput.addEventListener('change', previewHandler(roomPhotoPreview));\nform.addEventListener('submit', submitHandler);\n\n"],"sourceRoot":""}